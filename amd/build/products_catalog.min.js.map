{"version":3,"sources":["../src/products_catalog.js"],"names":["init","orderButtons","document","querySelectorAll","ADD_TO_ORDER_BUTTONS","forEach","button","addEventListener","productId","dataset","Ajax","call","methodname","args","then","response","warnings","length","Str","get_strings","key","component","langStrings","Notification","alert","catch","exception","addedNoteElement","nextElementSibling","remove","style","display"],"mappings":"ieAyBA,uDACA,OACA,O,6iBAEoB,QAAPA,CAAAA,IAAO,EAAM,IAMhBC,CAAAA,CAAY,CAAGC,QAAQ,CAACC,gBAAT,CAJH,CACdC,oBAAoB,CAAE,sBADR,CAI6B,CAAUA,oBAApC,CANC,CAOtBH,CAAY,CAACI,OAAb,CAAqB,SAACC,CAAD,CAAY,CAC7BA,CAAM,CAACC,gBAAP,CAAwB,OAAxB,CAAiC,UAAW,IAClCD,CAAAA,CAAM,CAAG,IADyB,CAGlCE,CAAS,CAAGF,CAAM,CAACG,OAAP,CAAeD,SAHO,CAWxCE,UAAKC,IAAL,CAAU,CAPM,CACZC,UAAU,CAAE,oCADA,CAEZC,IAAI,CAAE,CACF,UAAaL,CADX,CAFM,CAON,CAAV,EAAqB,CAArB,EACKM,IADL,CACU,SAACC,CAAD,CAAc,CAChB,GAAiC,CAA7B,GAAAA,CAAQ,CAACC,QAAT,CAAkBC,MAAtB,CAAoC,CAehCC,CAAG,CAACC,WAAJ,CAdgB,CACZ,CACIC,GAAG,CAAE,OADT,CAEIC,SAAS,CAAE,MAFf,CADY,CAKZ,CACID,GAAG,CAAE,wBADT,CAEIC,SAAS,CAAE,eAFf,CALY,CASZ,CACID,GAAG,CAAE,IADT,CAEIC,SAAS,CAAE,MAFf,CATY,CAchB,EACKP,IADL,CACU,SAACQ,CAAD,CAAiB,CACnBC,CAAY,CAACC,KAAb,CACIF,CAAW,CAAC,CAAD,CADf,CAEIA,CAAW,CAAC,CAAD,CAFf,CAGIA,CAAW,CAAC,CAAD,CAHf,CAKH,CAPL,EAQKG,KARL,CAQWF,CAAY,CAACG,SARxB,EAUA,MACH,CAED,GAAMC,CAAAA,CAAgB,CAAGrB,CAAM,CAACsB,kBAAhC,CACAtB,CAAM,CAACuB,MAAP,GACAF,CAAgB,CAACG,KAAjB,CAAuBC,OAAvB,CAAiC,OACpC,CAjCL,EAkCKN,KAlCL,CAkCWF,CAAY,CAACG,SAlCxB,CAmCH,CA9CD,CA+CH,CAhDD,CAiDH,C","sourcesContent":["// This file is not a part of Moodle - http://moodle.org/\n// This is a none core contributed module.\n//\n// This is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// The GNU General Public License\n// can be see at <http://www.gnu.org/licenses/>.\n\n/**\n * Module to add event listeners to elements on the products catalog page.\n *\n * @module     local_catalog/products_catalog\n * @package    local_catalog\n * @copyright  2021 Vitaly Potenko <potenkov@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport * as Notification from 'core/notification';\nimport * as Str from 'core/str';\n\nexport const init = () => {\n\n    const SELECTORS = {\n        ADD_TO_ORDER_BUTTONS: '.add-to-order-action'\n    };\n\n    const orderButtons = document.querySelectorAll(SELECTORS.ADD_TO_ORDER_BUTTONS);\n    orderButtons.forEach((button) => {\n        button.addEventListener('click', function() {\n            const button = this;\n\n            const productId = button.dataset.productId;\n            const request = {\n                methodname: 'local_catalog_add_product_to_order',\n                args: {\n                    'productid': productId\n                }\n            };\n\n            Ajax.call([request])[0]\n                .then((response) => {\n                    if (response.warnings.length !== 0) {\n                        const strings = [\n                            {\n                                key: 'error',\n                                component: 'core'\n                            },\n                            {\n                                key: 'addtoordererrormessage',\n                                component: 'local_catalog'\n                            },\n                            {\n                                key: 'ok',\n                                component: 'core'\n                            },\n                        ];\n                        Str.get_strings(strings)\n                            .then((langStrings) => {\n                                Notification.alert(\n                                    langStrings[0],\n                                    langStrings[1],\n                                    langStrings[2]\n                                );\n                            })\n                            .catch(Notification.exception);\n\n                        return;\n                    }\n\n                    const addedNoteElement = button.nextElementSibling;\n                    button.remove();\n                    addedNoteElement.style.display = 'block';\n                })\n                .catch(Notification.exception);\n        });\n    });\n};\n"],"file":"products_catalog.min.js"}